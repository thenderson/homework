	<body>
		<div class="container-fluid nopadding" id="bar-top">
			<div class="col-sm-12"><h3><strong>YOUR CURRENT COMMITMENTS</strong></h3></div>
		</div>
		
		<div class="container-fluid">
			<table id="bar-top">
				<tr>
					<td class="col-sm-3 filter nopadding">
						<div class="input-group">
							<div class="input-group-addon"><i class='fa fa-filter'></i></div>
							<input class="form-control input-sm" type="text" id="filter_all" name="filter"/>
						</div>
					</td>
					<td class="col-sm-3 add_commitment">
						<button type="button" class="btn btn-default btn-sm">New Commitment</button>
					</td>
					<td class="col-sm-6 paginator" id="user_commitments_paginator"></td>
				</tr>
			</table>
		</div>
		
		<div class="container-fluid">
			<div id="user_commitments">
				<div class="col-sm-12"><br><br><br><i class='fa fa-spinner fa-spin fa-3x text-center'></i></div>
			</div>
		</div>
		<br>

		<div class="container-fluid">
			<div class="col-sm-6 nopadding">
				<div class="col-sm-6 nopadding"><h3><strong>YOUR PROJECTS</strong></h3></div>
				<div class="col-sm-6 paginator nopadding" id="user_projects_paginator"></div>
				<div id="user_projects">
					<br><br><br><i class='fa fa-spinner fa-spin fa-3x text-center'></i>
				</div>
			</div>

			<div class="col-sm-6 nopadding">
				<div class="col-sm-6 nopadding"><h3><strong>ALL PROJECTS</strong></h3></div>
				<div class="col-sm-6 paginator nopadding" id="all_projects_paginator"></div>
				<div id="all_projects">
					<br><br><br><i class='fa fa-spinner fa-spin fa-3x text-center'></i>
				</div>
			</div>
		</div>
			
		<script src="./public/js/editablegrid.js"></script>
		<script src="./public/js/editablegrid_renderers.js" ></script>
		<script src="./public/js/editablegrid_editors.js" ></script>
		<script src="./public/js/editablegrid_validators.js" ></script>
		<script src="./public/js/editablegrid_utils.js" ></script>
		<!--<script src="./public/js/editablegrid_charts.js" ></script>-->
		<script src="./public/js/reliable.js" ></script>		

		<?php require 'dialogs.html'; ?>
	</body>
	
	<script type="text/javascript">
		window.onload = function() { 
		
			// pass to project-specific page
			goto_project_view = function (p_num) { 
				window.location.href = "../templates/project_commitments_form.php?project="+p_num;}
			
			// load commitments belonging to current user
			user_comm_grid = new EditableGrid("UserCommitments", {
				enableSort: true,
				editMode: 'static',
				dateFormat: "US",
				pageSize: 5,
				tableRendered:  function() { updatePaginator(this, "user_commitments_paginator"); },
				tableLoaded: function() {  
					user_comm_grid.setCellRenderer('project_number', new CellRenderer({ 
						render: function(cell, value) { 
							cell.innerHTML= "<a title=\"go to project page\" href=\"#\" onclick=\"goto_project_view(\'"+value+"\'); return false;\">"+value+"</a>";
						}
					}));
					this.renderGrid('user_commitments', 'table', 'commitments'); },
				modelChanged: function(rowIndex, columnIndex, oldValue, newValue, row) {
					updateCellValue(this, rowIndex, columnIndex, oldValue, newValue, row);
				}});
			
			$.ajax({
				url: '../includes/load_user_commitments.php',
				type: 'POST',
				dataType: "text",
				data: {
					horizon: 30
				},
				success: function (response) 
				{ //process response as xml, then call tableLoaded
					user_comm_grid.loadXMLFromString(response); //synchronous function
					user_comm_grid.tableLoaded();
				},
				error: function(XMLHttpRequest, textStatus, exception) 
				{ 
					alert("Ajax FAIL!\n" + "\nTextstatus: " + textStatus + "\nException: " + exception); 
				},
				async: true
			});
			
			user_proj_grid = new EditableGrid("UserProjects", {
				enableSort: true,
				dateFormat: "US",
				pageSize: 5,
				tableRendered:  function() { updatePaginator(this, "user_projects_paginator"); },
				tableLoaded: function() { 
					user_proj_grid.setCellRenderer('project_number_2', new CellRenderer({ 
						render: function(cell, value) { 
							cell.innerHTML= "<a title=\"go to project page\" href=\"#\" onclick=\"goto_project_view("+value+"); return false;\">"+value+"</a>";
						}
					}));
					this.renderGrid('user_projects', 'table', 'projects'); }
			}); 
				
			user_proj_grid.loadXML("../includes/load_user_projects.php");

			all_proj_grid = new EditableGrid("AllProjects", {
				enableSort: true,
				dateFormat: "US",
				pageSize: 5,
				tableRendered:  function() { updatePaginator(this, "all_projects_paginator"); },	
				tableLoaded: function() { 
					all_proj_grid.setCellRenderer('project_number_2', new CellRenderer({ 
						render: function(cell, value) { 
							cell.innerHTML= "<a title=\"go to project page\" href=\"#\" onclick=\"goto_project_view("+value+"); return false;\">"+value+"</a>";
						}
					}));
					this.renderGrid("all_projects", 'table', 'projects'); },
			});

			all_proj_grid.loadXML("../includes/load_all_projects.php");			
			
		}; 
	</script>